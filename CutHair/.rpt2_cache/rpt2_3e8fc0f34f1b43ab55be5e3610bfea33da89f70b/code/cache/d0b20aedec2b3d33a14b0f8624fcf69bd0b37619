{
  "code": "import { lwg, PalyAudio, EventAdmin, Admin } from \"../Lwg_Template/lwg\";\r\nimport GameMain3D from \"./GameMain3D\";\r\nexport default class UILoding extends lwg.Admin.Scene {\r\n    constructor() {\r\n        super();\r\n        this.lodingList_2D = [];\r\n        this.lodingList_3D = [];\r\n        this.lodingList_Data = [];\r\n        this.LodingType = {\r\n            Loding3D: 'Loding3D',\r\n            Loding2D: 'Loding2D',\r\n            LodingData: 'LodingData',\r\n            complete: 'complete',\r\n        };\r\n        this.maskMoveSwitch = true;\r\n        this.shearSpeed = 10;\r\n        this.shearSwitch = true;\r\n    }\r\n    lwgOnAwake() {\r\n        this.lodingList_2D = [\r\n            \"res/atlas/Frame/Effects.png\",\r\n            \"res/atlas/Frame/UI.png\",\r\n            \"res/atlas/UI/GameStart.png\",\r\n            \"res/atlas/UI/Common.png\",\r\n        ];\r\n        this.lodingList_3D = [\r\n            \"3DScene/LayaScene_SampleScene/Conventional/SampleScene.ls\"\r\n        ];\r\n        this.lodingList_Data = [];\r\n    }\r\n    adaptive() {\r\n        this.self['Bg'].height = Laya.stage.height;\r\n        this.self['Logo'].y = Laya.stage.height * 0.174;\r\n        this.self['Progress'].y = Laya.stage.height * 0.763;\r\n        this.self['FCM'].y = Laya.stage.height * 0.910;\r\n        this.self['FCM'].y = Laya.stage.height * 0.910;\r\n    }\r\n    lwgOnEnable() {\r\n        EventAdmin.notify(this.LodingType.Loding3D);\r\n    }\r\n    lwgEventReg() {\r\n        EventAdmin.reg(this.LodingType.Loding3D, this, () => { this.lodeScene3D(); });\r\n        EventAdmin.reg(this.LodingType.Loding2D, this, () => { this.loding2D(); });\r\n        EventAdmin.reg(this.LodingType.LodingData, this, () => { this.lodingData(); });\r\n        EventAdmin.reg(this.LodingType.complete, this, () => { this.completeLode(); });\r\n    }\r\n    lodeScene3D() {\r\n        if (this.lodingList_3D.length === 0) {\r\n            console.log('没有3D场景');\r\n            EventAdmin.notify(this.LodingType.Loding2D);\r\n            return;\r\n        }\r\n        Laya.Scene3D.load(this.lodingList_3D[0], Laya.Handler.create(this, (scene) => {\r\n            Laya.stage.addChildAt(scene, 0);\r\n            scene[Admin.SceneName.GameMain3D] = scene.addComponent(GameMain3D);\r\n            lwg.Admin._sceneControl[Admin.SceneName.GameMain3D] = scene;\r\n            console.log('3D场景加载完成！');\r\n            EventAdmin.notify(this.LodingType.Loding2D);\r\n        }));\r\n    }\r\n    loding2D() {\r\n        if (this.lodingList_2D.length === 0) {\r\n            console.log('没有需要加载的2D资源！');\r\n            EventAdmin.notify(this.LodingType.LodingData);\r\n            return;\r\n        }\r\n        Laya.loader.load(this.lodingList_2D, Laya.Handler.create(this, f => {\r\n            console.log('2D资源加载完成！');\r\n            EventAdmin.notify(this.LodingType.LodingData);\r\n        }));\r\n    }\r\n    lodingData() {\r\n        if (this.lodingList_Data.length === 0) {\r\n            console.log('没有数据表需要加载！');\r\n            EventAdmin.notify(this.LodingType.complete);\r\n            return;\r\n        }\r\n        Laya.loader.load(this.lodingList_Data, Laya.Handler.create(this, () => {\r\n            console.log('数据表加载完成！通过 Laya.loader.getRes(\"Data/levelsData.json\")[\"RECORDS\"]获取');\r\n            EventAdmin.notify(this.LodingType.complete);\r\n        }), null, Laya.Loader.JSON);\r\n    }\r\n    completeLode() {\r\n        this.self['Mask'].x = 0;\r\n        this.self['Shear'].x = this.self['Mask'].width;\r\n        this.self['Per'].text = 100 + '%';\r\n        Laya.timer.once(500, this, () => {\r\n            lwg.Admin._openScene(lwg.Admin.SceneName.UIStart);\r\n            this.self.close();\r\n        });\r\n    }\r\n    lwgOnUpdate() {\r\n        if (this.maskMoveSwitch) {\r\n            if (this.self['Mask'].x < -this.self['Mask'].width * 1 / 5) {\r\n                this.self['Mask'].x += this.self['Mask'].width / 25;\r\n                this.self['Shear'].x += this.self['Mask'].width / 25;\r\n                let str = ((-this.self['Mask'].width - this.self['Mask'].x) / -this.self['Mask'].width * 100).toString().substring(0, 2);\r\n                this.self['Per'].text = str + '%';\r\n            }\r\n        }\r\n        if (this.self['Shear_02'].rotation > 15) {\r\n            this.self['Shear_02']['dir'] = 'up';\r\n        }\r\n        else if (this.self['Shear_02'].rotation <= 0) {\r\n            this.self['Shear_02']['dir'] = 'down';\r\n        }\r\n        if (this.self['Shear_02']['dir'] === 'up') {\r\n            this.self['Shear_02'].rotation -= this.shearSpeed;\r\n            this.self['Shear_01'].rotation += this.shearSpeed;\r\n        }\r\n        else if (this.self['Shear_02']['dir'] === 'down') {\r\n            this.self['Shear_02'].rotation += this.shearSpeed;\r\n            this.self['Shear_01'].rotation -= this.shearSpeed;\r\n        }\r\n    }\r\n    lwgDisable() {\r\n        if (PalyAudio._voiceSwitch) {\r\n            lwg.PalyAudio.playMusic(lwg.Enum.voiceUrl.bgm, 0, 1000);\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/CutHair/Project/CutHair/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/CutHair/Project/CutHair/src/script/Game/GameMain3D.ts"
  ]
}
