{
  "code": "export class SubpackController {\r\n    constructor() {\r\n        this.pkgInfo = [\r\n            { name: \"sp1\", root: \"res\" },\r\n            { name: \"sp2\", root: \"3DScene\" },\r\n            { name: \"sp3\", root: \"3DPrefab\" },\r\n        ];\r\n    }\r\n    init(_completeFunc) {\r\n        this.completeFunc = _completeFunc;\r\n        this.pkgFlag = 0;\r\n        if (TJ.API.AppInfo.Channel() == TJ.Define.Channel.AppRt.WX_AppRt) {\r\n            this.loadPkg_wx();\r\n        }\r\n        else if (TJ.API.AppInfo.Channel() == TJ.Define.Channel.AppRt.VIVO_AppRt) {\r\n            this.loadPkg_VIVO();\r\n        }\r\n        else {\r\n            this.completeFunc();\r\n        }\r\n    }\r\n    loadPkg_VIVO() {\r\n        if (this.pkgFlag == this.pkgInfo.length) {\r\n            if (this.completeFunc) {\r\n                this.completeFunc();\r\n            }\r\n        }\r\n        else {\r\n            let info = this.pkgInfo[this.pkgFlag];\r\n            let name = info.name;\r\n            Laya.Browser.window.qg.loadSubpackage({\r\n                name: name,\r\n                success: (res) => {\r\n                    this.pkgFlag++;\r\n                    this.loadPkg_VIVO();\r\n                },\r\n                fail: (res) => {\r\n                    console.error(`load ${name} err: `, res);\r\n                },\r\n            });\r\n        }\r\n    }\r\n    loadPkg_wx() {\r\n        if (this.pkgFlag == this.pkgInfo.length) {\r\n            if (this.completeFunc) {\r\n                this.completeFunc();\r\n            }\r\n        }\r\n        else {\r\n            let info = this.pkgInfo[this.pkgFlag];\r\n            let name = info.name;\r\n            let root = info.root;\r\n            Laya.Browser.window.wx.loadSubpackage({\r\n                name: name,\r\n                success: (res) => {\r\n                    console.log(`load ${name} suc`);\r\n                    Laya.MiniAdpter.subNativeFiles[name] = root;\r\n                    Laya.MiniAdpter.nativefiles.push(root);\r\n                    this.pkgFlag++;\r\n                    console.log(\"加载次数\", this.pkgFlag);\r\n                    this.loadPkg_wx();\r\n                },\r\n                fail: (res) => {\r\n                    console.error(`load ${name} err: `, res);\r\n                },\r\n            });\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/CutHair/Project_Laya2.3.0/CutHair_Laya2.3.0/src/script/Game/UILoding.ts"
  ]
}
